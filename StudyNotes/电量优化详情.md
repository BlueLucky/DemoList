# 电量优化

### 1、WakeLock的使用

    wake_lock锁会阻止应用进程挂起，就是说当前进程给CPU加了WakeLock个锁使系统不会进入休眠状态，
    可以让应用进行后台操作。例如：上传下载文件，播放音乐等。
    
    WakeLock级别：
        PARTIAL_WAKE_LOCK：保证CPU保持高性能运行，而屏幕和键盘背光（也可能是触摸按键的背光）关闭。一般情况下都会使用这个WakeLock。
    
        ACQUIRE_CAUSES_WAKEUP：这个WakeLock除了会使CPU高性能运行外还会导致屏幕亮起，即使屏幕原先处于关闭的状态下。
    
        ON_AFTER_RELEASE：如果释放WakeLock的时候屏幕处于亮着的状态，则在释放WakeLock之后让屏幕再保持亮一小会。如果释放WakeLock的时候屏幕本身就没亮，则不会有动作。
    
        API17被弃用的WakeLock：保持屏幕长亮
    
            SCREEN_DIM_WAKE_LOCK：保证屏幕亮起，但是亮度可能比较低。同时键盘背光也可以不亮。
    
            SCREEN_BRIGHT_WAKE_LOCK ：保证屏幕全亮，同时键盘背光也亮。
    
            FULL_WAKE_LOCK：表现和SCREEN_BRIGHT_WAKE_LOCK 类似，但是区别在于这个等级的WakeLock使用的是最高亮度！

###### 使用步骤：

###### (1)、添加权限

```
<!--WakeLock需要的权限-->
<uses-permission android:name="android.permission.WAKE_LOCK"/>
```

###### (2)、获取电池服务，并执行操作

```java
PowerManager pm= (PowerManager) this.getSystemService(Context.POWER_SERVICE);
 PowerManager.WakeLock wakeLock=pm.newWakeLock(PowerManager.ON_AFTER_RELEASE|PowerManager.PARTIAL_WAKE_LOCK,"Tag");
 //申请WakeLock
 wakeLock.acquire();

 //... 执行操作...


 //释放wakeLock，否则CPU一直保持唤醒状态，不能休眠

 wakeLock.release();
```
